{"ast":null,"code":"var _jsxFileName = \"D:\\\\AQI_Index\\\\AQI-RealTime-System\\\\frontend\\\\src\\\\contexts\\\\AuthContext.js\",\n  _s = $RefreshSig$(),\n  _s2 = $RefreshSig$();\nimport React, { createContext, useContext, useState, useEffect } from 'react';\nimport { signInWithPopup, signOut, onAuthStateChanged } from 'firebase/auth';\nimport { ref, set, get, child } from 'firebase/database';\nimport { auth, googleProvider, database } from '../firebase-config';\n\n// Admin emails - add your admin email here\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst ADMIN_EMAILS = ['admin@gmail.com'\n// Add more admin emails here\n];\nconst AuthContext = /*#__PURE__*/createContext();\nexport const useAuth = () => {\n  _s();\n  const context = useContext(AuthContext);\n  if (!context) {\n    throw new Error('useAuth must be used within AuthProvider');\n  }\n  return context;\n};\n_s(useAuth, \"b9L3QQ+jgeyIrH0NfHrJ8nn7VMU=\");\nexport const AuthProvider = ({\n  children\n}) => {\n  _s2();\n  const [user, setUser] = useState(null);\n  const [loading, setLoading] = useState(true);\n\n  // Listen to auth state changes\n  useEffect(() => {\n    const unsubscribe = onAuthStateChanged(auth, async firebaseUser => {\n      if (firebaseUser) {\n        const userData = {\n          uid: firebaseUser.uid,\n          email: firebaseUser.email,\n          displayName: firebaseUser.displayName,\n          photoURL: firebaseUser.photoURL,\n          isAdmin: ADMIN_EMAILS.includes(firebaseUser.email),\n          lastLogin: new Date().toISOString()\n        };\n\n        // Save user to database\n        await saveUserToDatabase(userData);\n        setUser(userData);\n      } else {\n        setUser(null);\n      }\n      setLoading(false);\n    });\n    return () => unsubscribe();\n  }, []);\n\n  // Save user to Firebase Database\n  const saveUserToDatabase = async userData => {\n    try {\n      const userRef = ref(database, `users/${userData.uid}`);\n      await set(userRef, {\n        email: userData.email,\n        displayName: userData.displayName,\n        photoURL: userData.photoURL,\n        lastLogin: userData.lastLogin,\n        createdAt: userData.createdAt || new Date().toISOString()\n      });\n    } catch (error) {\n      console.error('Error saving user:', error);\n    }\n  };\n\n  // Google Sign In\n  const loginWithGoogle = async () => {\n    try {\n      const result = await signInWithPopup(auth, googleProvider);\n      return {\n        success: true,\n        user: result.user\n      };\n    } catch (error) {\n      console.error('Login error:', error);\n      return {\n        success: false,\n        error: error.message\n      };\n    }\n  };\n\n  // Logout\n  const logout = async () => {\n    try {\n      await signOut(auth);\n      return {\n        success: true\n      };\n    } catch (error) {\n      console.error('Logout error:', error);\n      return {\n        success: false,\n        error: error.message\n      };\n    }\n  };\n\n  // Get all users (admin only)\n  const getAllUsers = async () => {\n    try {\n      const dbRef = ref(database);\n      const snapshot = await get(child(dbRef, 'users'));\n      if (snapshot.exists()) {\n        const users = [];\n        snapshot.forEach(child => {\n          users.push({\n            uid: child.key,\n            ...child.val()\n          });\n        });\n        return users;\n      }\n      return [];\n    } catch (error) {\n      console.error('Error getting users:', error);\n      return [];\n    }\n  };\n  const value = {\n    user,\n    loading,\n    loginWithGoogle,\n    logout,\n    getAllUsers,\n    isAdmin: (user === null || user === void 0 ? void 0 : user.isAdmin) || false\n  };\n  return /*#__PURE__*/_jsxDEV(AuthContext.Provider, {\n    value: value,\n    children: children\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 122,\n    columnNumber: 9\n  }, this);\n};\n_s2(AuthProvider, \"NiO5z6JIqzX62LS5UWDgIqbZYyY=\");\n_c = AuthProvider;\nexport default AuthContext;\nvar _c;\n$RefreshReg$(_c, \"AuthProvider\");","map":{"version":3,"names":["React","createContext","useContext","useState","useEffect","signInWithPopup","signOut","onAuthStateChanged","ref","set","get","child","auth","googleProvider","database","jsxDEV","_jsxDEV","ADMIN_EMAILS","AuthContext","useAuth","_s","context","Error","AuthProvider","children","_s2","user","setUser","loading","setLoading","unsubscribe","firebaseUser","userData","uid","email","displayName","photoURL","isAdmin","includes","lastLogin","Date","toISOString","saveUserToDatabase","userRef","createdAt","error","console","loginWithGoogle","result","success","message","logout","getAllUsers","dbRef","snapshot","exists","users","forEach","push","key","val","value","Provider","fileName","_jsxFileName","lineNumber","columnNumber","_c","$RefreshReg$"],"sources":["D:/AQI_Index/AQI-RealTime-System/frontend/src/contexts/AuthContext.js"],"sourcesContent":["import React, { createContext, useContext, useState, useEffect } from 'react';\r\nimport {\r\n    signInWithPopup,\r\n    signOut,\r\n    onAuthStateChanged\r\n} from 'firebase/auth';\r\nimport { ref, set, get, child } from 'firebase/database';\r\nimport { auth, googleProvider, database } from '../firebase-config';\r\n\r\n// Admin emails - add your admin email here\r\nconst ADMIN_EMAILS = [\r\n    'admin@gmail.com',\r\n    // Add more admin emails here\r\n];\r\n\r\nconst AuthContext = createContext();\r\n\r\nexport const useAuth = () => {\r\n    const context = useContext(AuthContext);\r\n    if (!context) {\r\n        throw new Error('useAuth must be used within AuthProvider');\r\n    }\r\n    return context;\r\n};\r\n\r\nexport const AuthProvider = ({ children }) => {\r\n    const [user, setUser] = useState(null);\r\n    const [loading, setLoading] = useState(true);\r\n\r\n    // Listen to auth state changes\r\n    useEffect(() => {\r\n        const unsubscribe = onAuthStateChanged(auth, async (firebaseUser) => {\r\n            if (firebaseUser) {\r\n                const userData = {\r\n                    uid: firebaseUser.uid,\r\n                    email: firebaseUser.email,\r\n                    displayName: firebaseUser.displayName,\r\n                    photoURL: firebaseUser.photoURL,\r\n                    isAdmin: ADMIN_EMAILS.includes(firebaseUser.email),\r\n                    lastLogin: new Date().toISOString()\r\n                };\r\n\r\n                // Save user to database\r\n                await saveUserToDatabase(userData);\r\n                setUser(userData);\r\n            } else {\r\n                setUser(null);\r\n            }\r\n            setLoading(false);\r\n        });\r\n\r\n        return () => unsubscribe();\r\n    }, []);\r\n\r\n    // Save user to Firebase Database\r\n    const saveUserToDatabase = async (userData) => {\r\n        try {\r\n            const userRef = ref(database, `users/${userData.uid}`);\r\n            await set(userRef, {\r\n                email: userData.email,\r\n                displayName: userData.displayName,\r\n                photoURL: userData.photoURL,\r\n                lastLogin: userData.lastLogin,\r\n                createdAt: userData.createdAt || new Date().toISOString()\r\n            });\r\n        } catch (error) {\r\n            console.error('Error saving user:', error);\r\n        }\r\n    };\r\n\r\n    // Google Sign In\r\n    const loginWithGoogle = async () => {\r\n        try {\r\n            const result = await signInWithPopup(auth, googleProvider);\r\n            return { success: true, user: result.user };\r\n        } catch (error) {\r\n            console.error('Login error:', error);\r\n            return { success: false, error: error.message };\r\n        }\r\n    };\r\n\r\n    // Logout\r\n    const logout = async () => {\r\n        try {\r\n            await signOut(auth);\r\n            return { success: true };\r\n        } catch (error) {\r\n            console.error('Logout error:', error);\r\n            return { success: false, error: error.message };\r\n        }\r\n    };\r\n\r\n    // Get all users (admin only)\r\n    const getAllUsers = async () => {\r\n        try {\r\n            const dbRef = ref(database);\r\n            const snapshot = await get(child(dbRef, 'users'));\r\n            if (snapshot.exists()) {\r\n                const users = [];\r\n                snapshot.forEach((child) => {\r\n                    users.push({ uid: child.key, ...child.val() });\r\n                });\r\n                return users;\r\n            }\r\n            return [];\r\n        } catch (error) {\r\n            console.error('Error getting users:', error);\r\n            return [];\r\n        }\r\n    };\r\n\r\n    const value = {\r\n        user,\r\n        loading,\r\n        loginWithGoogle,\r\n        logout,\r\n        getAllUsers,\r\n        isAdmin: user?.isAdmin || false\r\n    };\r\n\r\n    return (\r\n        <AuthContext.Provider value={value}>\r\n            {children}\r\n        </AuthContext.Provider>\r\n    );\r\n};\r\n\r\nexport default AuthContext;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}